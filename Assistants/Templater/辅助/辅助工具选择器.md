<%*
try {
    const path = "TP模板脚本";
    const link = await tp.user.FLFolder(tp, path, true);
    if(!link) {
        new Notice("未选择文件");
        return;
    }
    const filePath = link.replace(/\[\[|\]\]/g, '');
    const content = await tp.file.include(`[[${filePath}]]`);
    // 确保 content 存在且移除首尾空白
    tR = (content || '').trim();
} catch(error) {
    console.error("模板执行错误:", error);
    new Notice(`错误：${error.message}`);
}
-%>